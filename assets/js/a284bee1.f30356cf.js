"use strict";(self.webpackChunkEat_The_Pie_docs=self.webpackChunkEat_The_Pie_docs||[]).push([[875],{7853:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var r=i(4848),t=i(8453);const s={},l="VDF Pietrzak Library",a={id:"smart-contracts/pietrzak-library",title:"VDF Pietrzak Library",description:"Github Link//github.com/eatthepie/contracts/blob/main/src/libraries/PietrzakLibrary.sol",source:"@site/docs/smart-contracts/pietrzak-library.md",sourceDirName:"smart-contracts",slug:"/smart-contracts/pietrzak-library",permalink:"/smart-contracts/pietrzak-library",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"VDF",permalink:"/smart-contracts/vdf-contract"},next:{title:"NFT",permalink:"/smart-contracts/nft-contract"}},o={},c=[{value:"Core Functions",id:"core-functions",level:2},{value:"VDF Verification",id:"vdf-verification",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Returns",id:"returns",level:4},{value:"Verification Process",id:"verification-process",level:4},{value:"Helper Functions",id:"helper-functions",level:3},{value:"Log2 Calculation",id:"log2-calculation",level:4},{value:"Hash128 Generation",id:"hash128-generation",level:4},{value:"Boolean to Uint Conversion",id:"boolean-to-uint-conversion",level:4}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"vdf-pietrzak-library",children:"VDF Pietrzak Library"})}),"\n",(0,r.jsxs)(n.p,{children:["Github Link: ",(0,r.jsx)(n.a,{href:"https://github.com/eatthepie/contracts/blob/main/src/libraries/PietrzakLibrary.sol",children:"https://github.com/eatthepie/contracts/blob/main/src/libraries/PietrzakLibrary.sol"})]}),"\n",(0,r.jsx)(n.p,{children:"The PietrzakLibrary implements the core verification logic for Pietrzak's Verifiable Delay Function (VDF). This library provides the mathematical operations and verification procedures necessary for validating VDF proofs in an efficient and secure manner."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.em,{children:["Adapted from ",(0,r.jsx)(n.a,{href:"https://github.com/usgeeus/Pietrzak-VDF-solidity-verifier",children:"usgeeus/Pietrzak-VDF-solidity-verifier"})]})}),"\n",(0,r.jsx)(n.h2,{id:"core-functions",children:"Core Functions"}),"\n",(0,r.jsx)(n.h3,{id:"vdf-verification",children:"VDF Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-solidity",children:"function verify(\n    BigNumber[] memory v,\n    BigNumber memory x,\n    BigNumber memory y,\n    BigNumber memory n,\n    uint256 delta,\n    uint256 T\n) internal view returns (bool)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v"}),": Array of intermediate values in the VDF computation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"x"}),": Initial input value (RANDAO value)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"y"}),": Claimed output value"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"n"}),": RSA modulus"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"delta"}),": Number of iterations to skip in verification"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"T"}),": Total number of iterations"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"returns",children:"Returns"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"bool"}),": True if the proof is valid, false otherwise"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"verification-process",children:"Verification Process"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Initialization"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Calculates tau (log2 of total iterations)"}),"\n",(0,r.jsx)(n.li,{children:"Determines maximum iterations for verification"}),"\n",(0,r.jsx)(n.li,{children:"Sets up BigNumber representation of 2"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Main Verification Loop"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Computes random challenges using _hash128"}),"\n",(0,r.jsx)(n.li,{children:"Updates x and y based on challenges and intermediate values"}),"\n",(0,r.jsx)(n.li,{children:"Performs modular arithmetic operations"}),"\n",(0,r.jsx)(n.li,{children:"Halves T in each iteration"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Final Verification"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Computes 2^delta efficiently"}),"\n",(0,r.jsx)(n.li,{children:"Verifies final relationship between x and y"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"helper-functions",children:"Helper Functions"}),"\n",(0,r.jsx)(n.h4,{id:"log2-calculation",children:"Log2 Calculation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-solidity",children:"function log2(uint256 value) internal pure returns (uint256)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Efficiently computes base-2 logarithm"}),"\n",(0,r.jsx)(n.li,{children:"Uses bit manipulation for performance"}),"\n",(0,r.jsx)(n.li,{children:"Processes in power-of-2 steps (128, 64, 32, etc.)"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"hash128-generation",children:"Hash128 Generation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-solidity",children:"function _hash128(\n    bytes memory a,\n    bytes memory b,\n    bytes memory c\n) internal pure returns (BigNumber memory)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Computes 128-bit hash from three inputs"}),"\n",(0,r.jsx)(n.li,{children:"Uses keccak256 for hashing"}),"\n",(0,r.jsx)(n.li,{children:"Returns last 16 bytes as BigNumber"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"boolean-to-uint-conversion",children:"Boolean to Uint Conversion"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-solidity",children:"function toUint(bool b) internal pure returns (uint256 u)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Converts boolean to uint256 (0 or 1)"}),"\n",(0,r.jsx)(n.li,{children:"Uses assembly for gas optimization"}),"\n",(0,r.jsx)(n.li,{children:"Memory-safe implementation"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var r=i(6540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);